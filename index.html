<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Desmos + Greek Keyboard</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://www.desmos.com/api/v1.6/calculator.js"></script>
</head>
<body>
  <h1>Desmos Graph + Greek Keyboard</h1>
  <div id="calculator" style="width: 600px; height: 400px;"></div>
  <div id="shift-toggle">Shift: <button id="shiftBtn">OFF</button></div>
  <div id="keyboard"></div>
  <script>
    const elt = document.getElementById('calculator');
    const calculator = Desmos.GraphingCalculator(elt, {
      expressions: true,
      settingsMenu: false
    });

    let shift = false;

    const greekLetters = [
      ['alpha', 'beta', 'gamma', 'delta', 'epsilon', 'zeta', 'eta', 'theta', 'iota', 'kappa',
       'lambda', 'mu', 'nu', 'xi', 'omicron', 'pi', 'rho', 'sigma', 'tau', 'upsilon',
       'phi', 'chi', 'psi', 'omega'],
      ['Alpha', 'Beta', 'Gamma', 'Delta', 'Epsilon', 'Zeta', 'Eta', 'Theta', 'Iota', 'Kappa',
       'Lambda', 'Mu', 'Nu', 'Xi', 'Omicron', 'Pi', 'Rho', 'Sigma', 'Tau', 'Upsilon',
       'Phi', 'Chi', 'Psi', 'Omega']
    ];

    const keyboardDiv = document.getElementById('keyboard');

    function renderKeyboard() {
      keyboardDiv.innerHTML = '';
      const row = document.createElement('div');
      (shift ? greekLetters[1] : greekLetters[0]).forEach(letter => {
        const button = document.createElement('button');
        button.textContent = letter;
        button.dataset.latex = `\\${letter}`;
        button.addEventListener('click', () => {
          const exprs = calculator.getExpressions();
          const selected = calculator.getSelectedExpression();
          const latex = button.dataset.latex.replace(/\\/g, '\\\\');
          if (selected) {
            calculator.setExpression({ id: selected.id, latex: (selected.latex || '') + latex });
          } else {
            const newId = `expr${Date.now()}`;
            calculator.setExpression({ id: newId, latex });
          }
        });
        row.appendChild(button);
      });
      keyboardDiv.appendChild(row);
    }

    renderKeyboard();

    document.getElementById('shiftBtn').addEventListener('click', () => {
      shift = !shift;
      document.getElementById('shiftBtn').textContent = shift ? 'ON' : 'OFF';
      renderKeyboard();
    });
  </script>
</body>
</html>
